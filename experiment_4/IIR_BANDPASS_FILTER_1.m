clc;clear all;close all;
alpp=5;
alpstop=30;
%wp=0.1;
%ws=0.2;
ws=[0.2 0.7];
wp=[0.1 0.8];
fp=400;
fstop=800;
fs=2000;
%wp=2*fp/fs;
%ws=2*fstop/fs;  
[n,wn]=buttord(wp,ws,alpp,alpstop);
[b,a]=butter(n,wn,'stop');
n1=fvtool(b,a);
w=0:0.01:pi;
[h,om]=freqz(b,a,w);
m=abs(h);
ang=angle(h);
subplot(2,1,1);
plot(om/pi,20*log(m));
grid;
xlabel('Frequency(radians/sample))');
ylabel('Magnitude()decibel)');
title('Magnitude response of IIR BANDSTOP filter');
subplot(2,1,2);
plot(om/pi,ang);
grid;
xlabel('Frequency(radians/samples)');
ylabel('Phase angle(degrees)');
title('Phase angle response of IIR BANDSTOP filter');
